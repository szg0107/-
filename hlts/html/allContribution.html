<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name=viewport content="user-scalable=no">
    <script type='text/javascript' src='js/pub.js'></script>
    <script type='text/javascript' src='js/check.js'></script>
    <script type='text/javascript' src='js/checkform.js'></script>
    <script type='text/javascript' src='res/js/KMoonPub.js'></script>
    <script language="javascript" src="js/check.js"></script>
    <title>Title</title>
    <style>
        .limitlength {
            table-layout: fixed;
            text-overflow: ellipsis;
            -o-text-overflow: ellipsis;
            overflow: hidden;
            white-space: nowrap;
        }
        .gps_font {
            font-size: 50px;
            color: black;
        }
    </style>
</head>
<body bgcolor="#efeef4" style="font-family: Heiti SC;">


<ylt.for dataId="1491880109981">
    <table width="100%" style="padding-left: 48px;background-color: white;" onclick="clickContribution('$value')"
           class="limitlength" name="contribution">
        <tr style="height: 100px;">
            <td style="font-size: 50px" class="limitlength">
                $value
            </td>
        </tr>
        <tr>
            <td style="font-size: 40px;color: gray; text-indent: 2em;" class="limitlength">
                $value
            </td>
        </tr>
    </table>
    <div style="padding-left: 48px;padding-right:48px;background-color: white;font-size: 35px;color: gray;border-bottom: 2px solid #efeef4;height: 50px;line-height: 50px;">
        $value    $value 点赞数:<span name="beizanshu">$value</span>
    </div>
</ylt.for>
<div id="tishi" class="gps_font" align="center"></div>

<form id="searchForm" action="allContribution.view" method="post">
    <input id="contentInput" name="content" style="width: 100%;" value="" type="text" hidden="true"/>
    <input id="circleID" name="id" style="width: 100%;" value="" type="text" hidden="true"/>
</form>
</body>


<script>
    var contribution = document.getElementsByName('contribution');
    if(contribution.length == 0){
        tishi.innerText="很抱歉，没有您想要的资源！";
    }
    function beiZanShuChuShiHua(){
        var bzs=document.getElementsByName("beizanshu");
        for(var i=0;i<bzs.length;i++){
            if(bzs[i].innerText==''||bzs[i].innerText==null||bzs[i].innerText == undefined || bzs[i].innerText == 'null'){
                bzs[i].innerText=0;
            }
        }
    }
    beiZanShuChuShiHua();

    function clickContribution(contributionID) {

        var isVIP = Can_the_content_be_viewed(getQueryString('id'));
        if(!isVIP){
            /*alert('您不是本圈子会员！请进行充值！');*/
            var userAgent = navigator.userAgent;
            if (userAgent.indexOf("iPhone") >= 0) {
                window.webkit.messageHandlers.needPay.postMessage(null);
            } else {
                window.callByJs.isVIP();
            }

            return;
        }

        addWatchCount(getQueryString('id'),contributionID,'contribute');



        var dict = {"contributionID": contributionID};
        var userAgent = navigator.userAgent;
        if (userAgent.indexOf("iPhone") >= 0) {
            window.webkit.messageHandlers.intoContributionIDDetails.postMessage(dict);
        } else {
            window.callByJs.setValue(contributionID);
        }
    }
    /**表单提交之前拿到id和输入内容**/
    /*var id="";
     var content="";
     <ylt.v message="id">
     $value
     id="$value";
     </ylt.v>
     <ylt.v message="content">
     $value
     content="$value";
     </ylt.v>
     var tempVar="id="+id+"&content="+content;
     function not_praise(index) {*/
    /**如果name=null将已赞隐藏**/

    /*for (var i = 0; i < index; i++) {
     if (document.getElementsByName("weizan")[i].getAttribute("zt")=="null") {
     document.getElementsByName("yizan")[i].style.display = "none";
     } else {
     document.getElementsByName("weizan")[i].style.display = "none";
     }

     }
     }*/
    /**获取数据的条数，调取方法**/
    /*var indexValue = document.getElementsByName("weizan").length;
     not_praise(indexValue);*/

    /**贡献的被赞数**/
    /*function contributeCountTest(circleID,contributionID){

     var newResultdfdfd=getTx("GcircleID="+circleID+"&contributeID="+contributionID,"phonejumpA.view");
     var likeContributeCount=incision(newResultdfdfd,"likeContributeCount=",";");
     var count;
     if(likeContributeCount == "" ||likeContributeCount==null||likeContributeCount=="null"){
     return   count=0;
     }else{
     return   count=parseInt(likeContributeCount);
     }
     }*/
    /**点赞**/
    /*function praise(ContributionID) {
     var timestamp = new Date().getTime();*/
    /**时间戳**/
    /*var newResult = getTx("lebie=gongxian&wzid=" + ContributionID, "phoneJump.view");
     var dianzanID = incision(newResult, "dianZan=", ";");
     if (dianzanID == "" || dianzanID == null || dianzanID == undefined || dianzanID == 'null') {
     var strVResult = sys_doComMandReturn("033", "S_DZWZ=" + ContributionID + "&S_ID=" + timestamp + "&S_LB=gongxian");
     var dianzanshu=  contributeCountTest(id,ContributionID);
     var newdianzanshu=parseInt(dianzanshu)+1;*//**新点赞数**/
    /* var strVResultbbb = sys_doComMandReturn("037", "S_BDZS=" + newdianzanshu + "&S_ID=" + ContributionID + "&S_QZBID="+id);
     window.location = "allContribution.view?"+tempVar;
     }

     }*/
    /**取消赞**/
    /*function unpraise(ContributionID) {
     var newResult = getTx("lebie=gongxian&wzid=" + ContributionID, "phoneJump.view");
     var dianzanID = incision(newResult, "dianZan=", ";");
     if (dianzanID != "" || dianzanID != null || dianzanID != undefined || dianzanID != 'null') {
     var strVResult = sys_doComMandReturn("034", "S_ID=" + dianzanID);
     var dianzanshu=  contributeCountTest(id,ContributionID);
     var newdianzanshu=parseInt(dianzanshu)-1;*//**新点赞数**/
    /*var strVResultbbb = sys_doComMandReturn("037", "S_BDZS=" + newdianzanshu + "&S_ID=" + ContributionID + "&S_QZBID="+id);
     window.location = "allContribution.view?"+tempVar;
     }

     }
     function incision(Result, start, over) {
     Result = Result.substr(Result.indexOf(start));
     Result = Result.substr(0, Result.indexOf(over));*/
    /**alert("后"+strResult);**/
    /*Result = Result.split(start)[1];
     return Result;
     }*/

</script>
<script>
    function getQueryString1(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        var r = decodeURI(window.location.href).substr(1).match(reg);
        if (r != null) return unescape(r[2]); return null;
    }
    function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        var r =  window.location.search.substr(1).match(reg);
        if (r != null) return unescape(r[2]); return null;
    }
    if(getQueryString('content') != "" && getQueryString('content') != null) {
        var timestamp = new Date().getTime();
        var contentInput = document.getElementById('contentInput');
        contentInput.value = getQueryString1('content');
        var circleID = document.getElementById('circleID');
        circleID.value = getQueryString('id');
        var searchForm =  document.getElementById('searchForm');
        searchForm.action = "allContribution.view" +"?id="+ getQueryString('id');
        if(contentInput.value!=''&&contentInput.value!=null){
            var Searchrecords = sys_doComMandReturn("040", "S_QZBID=" + getQueryString('id') + "&S_SSSJ=" + timestamp + "&S_SSNR=" + contentInput.value+ "&S_ID=" + timestamp+"&S_SSLX=contribute");
        }
        searchForm.submit();
    }
</script>
</html>
