<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script type='text/javascript' src='js/pub.js'></script>
    <script type='text/javascript' src='js/check.js'></script>
    <script type='text/javascript' src='js/checkform.js'></script>
    <script type='text/javascript' src='res/js/KMoonPub.js'></script>
    <script type='text/javascript' src='res/js/resource.js'></script>

    <meta name=viewport content="user-scalable=no">

    <style>
        .gps_font {
            font-size: 45px;
            color: black;
        }

        .limitlength {
            table-layout: fixed;
            text-overflow: ellipsis;
            -o-text-overflow: ellipsis;
            overflow: hidden;
            white-space: nowrap;
        }
        .divFrame {

            background-color: #FFFFFF;
            margin: 20px auto 0;
            border-top-right-radius: 4px;
            border-top-left-radius: 4px;
            border-bottom-left-radius: 4px;
            border-bottom-right-radius: 4px;
            border-color:#C0C0C0;
            border-style: solid;
            border-width: 15px;
            display:none;
            position:fixed;
            bottom:0px;
            left:0px;
            right:0px;
            height: 140px;
            width: 97%;
            /*background: border-width: 2px;;
            border-style: solid;
            border-color:black;
            border-width: 2px;*/
        }

        .inputPsorText {
            background-color: transparent;
            border: 0 none;
            float: left;
            margin-left: 12px;
            font-size: 55px;
            font-family: 微软雅黑;
            margin-top:2px;
            width: 64%;
            height: 120px;
            line-height: 120px;
            margin-top:15px;
            margin-left:3%
        }
        .menus{
            text-align: center;
            color: #FFFFFF;
            background:#029ae5;
            border-color:white;
            border-style: none;
            border-width: 0px;
            font-size: 50px;
            /*margin-left:1px;*/
            /*width: 24.4%;*/
            height:90px;
        }
    </style>

</head>


<body id="body1" bgcolor="#efeef4">

<div id="timu" style="display:none;width: 100%;height: 120px;background: #029ae5;line-height: 120px;margin-top:0px;border-style: blue; border-width: 1px;"  ><!--微信公众号使用-->
    <img src="res/images/arrow_left_d.png" style="width: 10%;height: 40%;margin-top:0%" onclick="window.history.go(-1);">
    <span id="menu2" style="color: #FFFFFF;font-size: 50px;margin-left:30%;font-family: 微软雅黑;margin-top:10%">公司必修</span>
    <span id="A" style="color: #FFFFFF;font-size: 35px;margin-left:15%;font-family: 微软雅黑;" onclick="moshi1()">开启</span>
    <span id="B" style="color: #FFFFFF;font-size: 35px;margin-left:-2px;font-family: 微软雅黑;"onclick="moshi1()">无图模式</span>

</div>

<div id="menu" style="display:none;width: 100%;height: 100px;line-height: 100px;line-width: 500px;margin-top:3px;"  ><!--微信公众号使用-->
    <input id="" name="menu" type="button" onclick="play(this);" class="menus" style="display:none" value="">
    <input id="" name="menu" type="button" onclick="play(this);" class="menus" style="display:none" value="">
    <input id="" name="menu" type="button" onclick="play(this);" class="menus" style="display:none" value="">
    <input id="" name="menu" type="button" onclick="play(this);" class="menus" style="display:none" value="">
</div>



<ylt.for dataId="1499136872517">
    <div style="margin-top: 0px;margin-left: 40px;margin-right: 40px;clear: both;"  name="pagingDiv">
        <div onclick="clickPicture('$value',this);recordLrecord('$value');" name="picture">
            <div class="gps_font" style="background-color: #efeef4;height: 100%;margin-top: 30px;overflow:auto;">
                <!--<div style="float: left;width: 15%;" class="gps_font">主题：</div>-->
                <div class="gps_font" style="float: left;width: 98%;margin-left: 10px;">
                    <img name="dian" src="res/images/dianA.png" style="position: relative;z-index: 999;right: 0;top: 0;float: right;width:30px;height:30px;display: none;">
                    <div name="title" style="float: left;word-break: break-all;word-wrap: break-word;">$value</div>
                </div>
            </div>
        </div>

        <div style="height: 100px;" align="center">
            <div  style="font-size: 35px;color: gray;float: left;margin-top: 30px;width: 300px;">
                $value
            </div>


            <div style="float: left;margin-top: 30px;margin-left: 80px;width: 200px;" align="left">
                   <span style="font-size: 35px;color: gray;border-bottom: 2px solid #efeef4;height: 50px;line-height: 50px;margin-left: 10%">
                    点赞数:
                    <span name="zanCount"></span>
                   </span>
            </div>

            <div name="content" hidden="true" style="float: left;width: 83%;height: 260px;white-space:normal;border-radius: 10px;margin-left: 10px;"class="limitlength gps_font">
                $value
            </div>
            <div style="float: left;margin-top: 20px;margin-left: 40px;">
                <img src="res/images/wx_share.png"  name="share" onclick="wx_share(this,'$value')" />
            </div>
            <div style="float: left;margin-top: 20px;margin-left: 40px;">
                <img src="res/images/bluePraise.png" onclick="praise(getQueryString('id'),'png',this)" id="$value"
                     name="zan" align="right" style="width: 60px;height: 60px;margin-left: 10%"/>
            </div>


            <div class="gps_font" style="background-color: #efeef4;float: left;margin-left: 40px">
                <img name="shoucang" src="res/images/weishoucang.png" alt="$value"
                     onclick="collect(this,this.alt,'png',getQueryString('id'))"
                     style="margin-top: 20px;width: 60px;height: 60px;"/>
            </div>
        </div>

        <div style="background-color: white;clear: both;" name="juli">
            <hr size="3" style="background: #666;border: 0;">
        </div>
    </div>
</ylt.for>

<div id="sousu" class="divFrame">
    <img src="res/images/ss.png"  style="float:left;margin-top: 15px;margin-left: 15px;background-size: 50%;height: 80%;">
    <input id="con" class="inputPsorText" name="con" value=""  placeholder="请输入搜索关键字" autocomplete="on" type="text">
    <img src="res/images/jg.png" onclick="sous()" style="float:left;margin-top: 15px;margin-left: 5%;background-size: 50%;height: 80%;">
</div>

<div id="tishi" class="gps_font" align="center"></div>

<form id="searchForm" action="searchAudio.view" method="post">
    <input id="contentInput" name="content" style="width: 100%;" value="" type="text" hidden="true"/>
    <input id="circleID" name="id" style="width: 100%;" value="" type="text" hidden="true"/>
</form>
</body>



<script>
    function wx_share(element,fileName) {
        var shareArray = document.getElementsByName('share');
        var titleArray = document.getElementsByName('title');
        var contentArray = document.getElementsByName('content');
        var index;
        for(var i=0;i<shareArray.length;i++){
            if(shareArray[i]==element){
                index = i;
            }
        }

        var content = contentArray[index].innerHTML;
        var title = titleArray[index].innerHTML;

        var data = {"title": title,"content":content,"fileName":fileName};
        var stringArray = [title,content,fileName];
        var userAgent = navigator.userAgent;
        if (userAgent.indexOf("iPhone") >= 0) {
            window.webkit.messageHandlers.wx_share.postMessage(data);
        } else {
            window.callByJs.weChatShare(stringArray);
        }
    }
</script>
<script>
    function getQueryString1(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        var r = decodeURI(window.location.href).substr(1).match(reg);
        if (r != null) return unescape(r[2]); return null;
    }
    updateZan('png',getQueryString('id'));


    var imgs = document.getElementsByName('picture');
    for(var i=0;i<imgs.length;i++){
        var index = imgs[i].src.indexOf('upload/');
        var newStr = imgs[i].src.substring(index+7,imgs[i].length);

        if(newStr.indexOf('http') == 0){
            imgs[i].src = newStr;
        }
    }
</script>


<script>
    function updateShouCang() {

        var shoucangs = document.getElementsByName('shoucang');
        for (var i = 0; i < shoucangs.length; i++) {
            if(collectStatus(shoucangs[i].alt,'png')){
                shoucangs[i].src =  "res/images/shoucang.png";
            }else{
                shoucangs[i].src =  "res/images/weishoucang.png";
            };
        }
    }
    updateShouCang();
</script>


</body>

<script type="text/javascript">
    var picture = document.getElementsByName('picture');
    if(picture.length == 0){
        tishi.innerText="很抱歉，没有您想要的资源！";
    }
    function clickPicture(picture,element) {

        var isVIP = Can_the_content_be_viewed(getQueryString('id'));
        if(!isVIP){
            if (getQueryString('kind') != null) {
                alert('您不是本圈子会员！请进行充值！');
            } else {
                /*alert('您不是本圈子会员！请进行充值！');*/
                var userAgent = navigator.userAgent;
                if (userAgent.indexOf("iPhone") >= 0) {
                    window.webkit.messageHandlers.needPay.postMessage(null);
                } else {
                    window.callByJs.isVIP();
                }
                return;
            }
        } else {
            if (getQueryString('kind') != null) {
                this.location.href="upload/"+picture;
            }
        }
        var aviDivArray=document.getElementsByName("picture");
        var dianArray=document.getElementsByName("dian");
        for(var i=0;i<aviDivArray.length;i++){
            if(aviDivArray[i]==element){
                if(dianArray[i].style.display=="inline"){
                    dianArray[i].style.display="none";
                }
            }
        }
        var content = {"picture": picture};

        var userAgent = navigator.userAgent;
        if (userAgent.indexOf("iPhone") >= 0) {
            window.webkit.messageHandlers.pictureClick.postMessage(content);
        } else {
            window.callByJs.setValue(picture);
        }

    }
    function PopupWindow(content) {
        var contentbuttons = document.getElementsByName('contentButton');
        var neirong="";
        for(var i = 0;i<contentbuttons.length;i++){
            if(contentbuttons[i] == content){
                neirong=document.getElementsByName('content')[i].innerHTML;
                neirong = neirong.replace(/(^\s*)/g,"");
                var title=document.getElementsByName('title')[i].innerHTML;
                var data = {"title": title,"content":neirong};
                var userAgent = navigator.userAgent;
                if (userAgent.indexOf("iPhone") >= 0) {
                    window.webkit.messageHandlers.details.postMessage(data);
                } else {
                    alert("主题:\n\t\t"+title.replace(/(^\s*)/g,"")+"\n"+"简介:\n\t\t"+neirong);
                }
            }
        }
    }
    function recordLrecord(ID){
        /*记录学习情况*/
        addWatchCount(getQueryString('id'),ID,'png');

        var timestamp = new Date().getTime();
        var record_Learning = sys_doComMandReturn("030", "S_QZID=" +getQueryString('id') + "&S_WAID=" +ID + "&S_XXLX=png" + "&S_XXSJ=" +timestamp+ "&S_ID=" + timestamp);
    }
    function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        var r =  window.location.search.substr(1).match(reg);
        if (r != null) return unescape(r[2]); return null;
    }
    /*搜索记录方法*/
    function SearchRecords(circleID,content){
        var timestamp = new Date().getTime();
        var Searchrecords = sys_doComMandReturn("040", "S_QZBID=" + circleID + "&S_SSSJ=" + timestamp + "&S_SSNR=" + content+ "&S_ID=" + timestamp+"&S_SSLX=png");
    }


    function xianShiYuanDian(){
        var imgs=document.getElementsByName('dian');
        var imgs2=document.getElementsByName('zan');
        var gongSiBiXiuID=new Array();
        var gongSiBiXiuCongFU=new Array();
        var gongSiBiXiuCongType=new Array();
    <ylt.for dataId="1503383626200">
                gongSiBiXiuID.push('$value');
        gongSiBiXiuCongFU.push('$value');
        gongSiBiXiuCongType.push('$value');
    </ylt.for>
        var xinBiXiuID=array_assignment(gongSiBiXiuCongType,gongSiBiXiuID,getQueryString('type'));
        if(gongSiBiXiuCongFU.length!=0){
            if(array_contain(gongSiBiXiuCongFU,'zero')&&array_contain(gongSiBiXiuCongType,getQueryString('type'))){
                for(var i=0;i<xinBiXiuID.length;i++){
                    for(var u=0;u<imgs2.length;u++){
                        if(xinBiXiuID[i]==imgs2[u].id){
                            imgs[u].style.display="inline";
                        }
                    }
                }
            }
            if(array_contain(gongSiBiXiuCongFU,'one')&&array_contain(gongSiBiXiuCongType,getQueryString('type'))){
                for(var i=0;i<xinBiXiuID.length;i++){
                    for(var u=0;u<imgs2.length;u++){
                        if(xinBiXiuID[i]==imgs2[u].id){
                            imgs[u].style.display="inline";
                        }
                    }
                }
            }
        }

    }
    xianShiYuanDian();
    /*判断数组是否包含某个值*/
    function array_contain(array, obj){
        for (var i = 0; i < array.length; i++){
            if (array[i] == obj)/*如果要求数据类型也一致，这里可使用恒等号===*/
                return true;
        }
        return false;
    }
    /*根据必修类别与传进的类别进行对比，然后将相同类型的必修ID赋值到新数组*/
    function array_assignment(gongSiBiXiuCongType,gongSiBiXiuID,obj){
        var file_array=new Array();
        for(var i=0;i<gongSiBiXiuCongType.length;i++){
            if(gongSiBiXiuCongType[i]==obj){
                file_array.push(gongSiBiXiuID[i]);
            }
        }
        return file_array;
    }
</script>

<script>
    if(getQueryString('content') != null) {
        var contentInput = document.getElementById('contentInput');
        contentInput.value = getQueryString1('content');
        var circleID = document.getElementById('circleID');
        circleID.value = getQueryString('id');
        var searchForm =  document.getElementById('searchForm');
        searchForm.action="no_img_picture.view?w=a&type="+getQueryString('type')+"&id="+circleID.value+"&reuse="+getQueryString('reuse')+"&catalogueId=";
        /*if(contentInput.value!=''&&contentInput.value!=null){
         var timestamp = new Date().getTime();
         var Searchrecords = sys_doComMandReturn("040", "S_QZBID=" + circleID.value + "&S_SSSJ=" + timestamp + "&S_SSNR=" + contentInput.value+ "&S_ID=" + timestamp+"&S_SSLX=mp3");
         }*/
        searchForm.submit();
    }
</script>






<!--微信公众号使用js-->
<script>
    <ylt.for dataId="1499223736665">
    var resources = new Array();
    var isOpenCategory = new Array();
    resources[0] = "$value";
    resources[1] = "$value";
    resources[2] = "$value";
    resources[3] = "$value";
    var resourcesShunXu = "$value".split("_");
    isOpenCategory[0] = "$value";
    isOpenCategory[1] = "$value";
    isOpenCategory[2] = "$value";
    isOpenCategory[3] = "$value";
    </ylt.for>

    <ylt.for dataId="1499258859463">
    var resourcesCount =new Array();
    resourcesCount[0]="$value";
    resourcesCount[1]="$value";
    resourcesCount[2]="$value";
    resourcesCount[3]="$value";
    </ylt.for>

    <ylt.for dataId="1501569638831">
    var resources_one = new Array();
    var isOpenCategory_one = new Array();
    resources_one[0] = "$value";
    resources_one[1] = "$value";
    resources_one[2] = "$value";
    resources_one[3] = "$value";
    var resourcesShunXu_one = "$value".split("_");
    isOpenCategory_one[0] = "$value";
    isOpenCategory_one[1] = "$value";
    isOpenCategory_one[2] = "$value";
    isOpenCategory_one[3] = "$value";
    </ylt.for>

    <ylt.for dataId="1501569890801">
    var resourcesCount_one =new Array();
    resourcesCount_one[0]="$value";
    resourcesCount_one[1]="$value";
    resourcesCount_one[2]="$value";
    resourcesCount_one[3]="$value";
    </ylt.for>
</script>
<script>

    function showmenu(){
        var menus = document.getElementsByName("menu");
        var number = 0;
        var width = 0;
        var id = "";
        for(var i=0;i<4;i++){
            if(parseInt(resourcesCount[i]) > 0){
                number = number + 1;
            }
        }
        switch(number){
            case 1 : width = 98.4;break;
            case 2 : width = 49.1;break;
            case 3 : width = 32.6;break;
            case 4 : width = 24.4;break;
            default : width = 0;break;
        }

        var k = 0;
        for(var i=0;i<4;i++){
            var shunxu = parseInt(resourcesShunXu[i]);/*字符串转数字*/
            if(parseInt(resourcesCount[shunxu]) > 0){
                menus[i].value = resources[shunxu];
                switch(shunxu){
                    case 0 : id = "avi";break;
                    case 1 : id = "png";break;
                    case 2 : id = "mp3";break;
                    case 3 : id = "pdf";break;
                }
                menus[i].style.width = width+"%";
                menus[i].id = id;
                menus[i].style.display = "";
                menus[i].style.marginLeft = "1px";
            }

        }
        for(var i=0;i<4;i++){
            if (menus[i].style.display == "") {
                menus[i].style.marginLeft = "5px";
                break;
            }
        }
    }
    function showmenu1(){
        var menus = document.getElementsByName("menu");
        var number = 0;
        var width = 0;
        var id = "";
        for(var i=0;i<1;i++){
            if(parseInt(resourcesCount_one[i]) > 0){
                number = number + 1;
            }
        }
        switch(number){
            case 1 : width = 98.4;break;
            case 2 : width = 49.1;break;
            case 3 : width = 32.6;break;
            case 4 : width = 24.4;break;
            default : width = 0;break;
        }

        for(var i=0;i<1;i++){
            var shunxu = parseInt(resourcesShunXu_one[i]);/*字符串转数字*/
            if(parseInt(resourcesCount_one[shunxu]) > 0){
                menus[i].value = resources_one[shunxu];
                switch(shunxu){
                    case 0 : id = "avi";break;
                    case 1 : id = "png";break;
                    case 2 : id = "mp3";break;
                    case 3 : id = "pdf";break;
                }
                menus[i].style.width = width+"%";
                menus[i].id = id;
                menus[i].style.display = "";
                menus[i].style.marginLeft = "1px";
            }
        }
        for(var i=0;i<4;i++){
            if (menus[i].style.display == "") {
                menus[i].style.marginLeft = "5px";
                break;
            }
        }
    }
    if (getQueryString('reuse') == "zero") {
        showmenu();
    } else if (getQueryString('reuse') == "one"){
        showmenu1();
    }
</script>

<script>
    var menuname = getQueryString1("menuname");
    var yinc = getQueryString('w');
    if (getQueryString('kind') != null) {/*微信公众号使用*/
        var tm = getQueryString('kind');
        var cc = getQueryString('con');
        if (tm == "44") {
            document.getElementById("menu2").innerText = menuname;
            document.getElementById("timu").style.display = "block";
            document.getElementById("menu").style.display = "block";
            document.getElementById("png").style.background = "white";
            document.getElementById("png").style.color = "#029ae5";
            /*document.getElementById("shipin").style.background = "#029ae5";
             document.getElementById("shipin").style.color = "white";
             document.getElementById("yinpin").style.background = "#029ae5";
             document.getElementById("yinpin").style.color = "white";
             document.getElementById("wenan").style.background = "#029ae5";
             document.getElementById("wenan").style.color = "white";*/
            document.getElementById("A").innerText = "关闭";
            document.getElementById("body1").style.margin="0px";
            document.getElementById("sousu").style.display = "block";
            if (yinc !="a" &&　cc != null) {
                document.getElementById("body1").style.display = "none";
                show();
            }
        }
    }
    if (getQueryString('kind') != null) {
        var pagingDivs = document.getElementsByName('pagingDiv');
        var count = pagingDivs.length;
        if (count > 1) {
            document.getElementsByName('juli')[count-1].style.marginBottom="220px";
        }
    }
    function sous() {
        var c = document.getElementById("con").value;
        if (c=="") {
            alert("搜索内容为空！");
        } else {
            var circleID = getQueryString('id');
            var reuse = getQueryString('reuse');
            var contentInput = document.getElementById('contentInput');
            contentInput.value = c;
            var circleID = document.getElementById('circleID');
            circleID.value = getQueryString('id');
            var searchForm =  document.getElementById('searchForm');
            searchForm.action="no_img_picture.view?kind=44&ms=1&w=a&type="+getQueryString('type')+"&id="+circleID.value+"&reuse="+getQueryString('reuse')+"&menuname="+menuname+"&con="+contentInput.value+"&catalogueId=";
            searchForm.submit();
        }
    }

    if (yinc=='a') {
        if ( document.getElementById("sousu")!=null) {
            document.getElementById("sousu").style.display = "none";
        }
    }
    function show() {
        if (getQueryString('con') != null) {
            var contentInput = document.getElementById('contentInput');
            contentInput.value = getQueryString1('con');
            var circleID = document.getElementById('circleID');
            circleID.value = getQueryString('id');
            var searchForm =  document.getElementById('searchForm');
            searchForm.action="no_img_picture.view?kind=44&ms=1&w=a&type="+getQueryString('type')+"&id="+circleID.value+"&reuse="+getQueryString('reuse')+"&menuname="+menuname+"&con="+contentInput.value+"&catalogueId=";
            searchForm.submit();
        }
    }
</script>
<script>/*微信公众号使用*/
var moshi = 1;
function moshi1() {
    var w = document.getElementById("A").innerText;
    if (w=="开启") {
        moshi = 1;
        document.getElementById("A").innerText = "关闭";
    } else if (w=="关闭") {
        moshi = 0;
        var circleID = getQueryString('id');
        var reuse = getQueryString('reuse');
        var c = getQueryString1('con');
        var catalogueId = getQueryString('catalogueId');
        if (catalogueId != undefined && catalogueId != "") {
            if (getQueryString('reuse') == "zero") {
                page = "gsbx.view?reuse=zero&type="+type+"&id=";
            } else if (getQueryString('reuse') == "one"){
                page = "gsbx.view?reuse=one&type="+type+"&id=";
            }
            page = page+circleID+"&menuname="+menuname;
        } else {
            if (c != null) {
                this.location.href="picture.view?kind=88&type=png&ms="+moshi+"&id=" + circleID+"&menuname="+menuname+"&reuse="+reuse+"&con="+c+"&catalogueId=";
            } else {
                this.location.href="picture.view?kind=88&type=png&ms="+moshi+"&id=" + circleID+"&menuname="+menuname+"&reuse="+reuse+"&catalogueId=";
            }
        }
    }
}
function play(obj){
    var type = obj.id;
    var page = "";
    var circleID = getQueryString('id');
    var reuse = getQueryString('reuse');
    var catalogueId = getQueryString('catalogueId');
    /*alert("catalogueId:"+catalogueId);*/
    if (catalogueId != undefined && catalogueId != "") {
        if (getQueryString('reuse') == "zero") {
            page = "gsbx.view?reuse=zero&type="+type+"&id=";
        } else if (getQueryString('reuse') == "one"){
            page = "gsbx.view?reuse=one&type="+type+"&id=";
        }
        page = page+circleID+"&menuname="+menuname;
    } else {
        if (yinc != "a") {
            if (moshi==1) {
                switch (type) {
                    case "avi":
                        page = "no_img_videoList.view?kind=11";
                        break;
                    case "mp3":
                        page = "no_img_audio.view?kind=22";
                        break;
                    case "pdf":
                        page = "no_img_courseware.view?kind=33";
                        break;
                    case "png":
                        page = "no_img_picture.view?kind=44";
                        break;
                }
                page = page + "&ms="+moshi+"&type="+type+"&id=" + circleID+"&menuname="+menuname+"&reuse="+reuse+"&catalogueId=";
            } else {
                switch (type) {
                    case "avi":
                        page = "videoList.view?kind=55";
                        break;
                    case "mp3":
                        page = "audio.view?kind=66";
                        break;
                    case "pdf":
                        page = "coursewareList.view?kind=77";
                        break;
                    case "png":
                        page = "picture.view?kind=88";
                        break;
                }
                page = page + "&ms="+moshi+"&type="+type+"&id=" + circleID+"&menuname="+menuname+"&reuse="+reuse+"&catalogueId=";
            }
        }else {
            var c = getQueryString1('con');
            if (moshi==1) {
                switch (type) {
                    case "avi":
                        page = "no_img_videoList.view?kind=11";
                        break;
                    case "mp3":
                        page = "no_img_audio.view?kind=22";
                        break;
                    case "pdf":
                        page = "no_img_courseware.view?kind=33";
                        break;
                    case "png":
                        page = "no_img_picture.view?kind=44";
                        break;
                }
                page = page + "&type="+type+"&ms="+moshi+"&id=" + circleID+"&menuname="+menuname+"&reuse="+reuse+"&con="+c+"&catalogueId=";
            } else {
                switch (type) {
                    case "avi":
                        page = "videoList.view?kind=55";
                        break;
                    case "mp3":
                        page = "audio.view?kind=66";
                        break;
                    case "pdf":
                        page = "coursewareList.view?kind=77";
                        break;
                    case "png":
                        page = "picture.view?kind=88";
                        break;
                }
                page = page + "&type="+type+"&ms="+moshi+"&id=" + circleID+"&menuname="+menuname+"&reuse="+reuse+"&con="+c+"&catalogueId=";
            }
        }

    }

    this.location.href=page;
}
</script>
</html>
